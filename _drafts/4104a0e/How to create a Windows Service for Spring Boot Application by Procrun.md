---
layout: post
title:  "How to create a Windows Service for Spring Boot Application by Procrun"
title2:  "How to create a Windows Service for Spring Boot Application by Procrun"
date:   2018-11-16 03:44:31  +0800
source:  "https://grokonez.com/java-integration/create-windows-service-spring-boot-application-procrun"
fileName:  "4104a0e"
lang:  "en"
published: false

---
Procrun is a set of applications that allow Windows users to wrap (mostly) Java applications (e.g. Tomcat) as a Windows service. The service can be set to automatically start when the machine boots and will continue to run with no user logged onto the machine.

The tutorial will guide you how to create a Windows Service for Spring Boot Application by Procrun.

Contents

*   [I. Technologies – create a Windows Service for Spring Boot Application by Procrun](#I_Technologies_8211_create_a_Windows_Service_for_Spring_Boot_Application_by_Procrun)
*   [II. Overview](#II_Overview)
    *   [1\. Structure of Project](#1_Structure_of_Project)
    *   [2\. Step to do](#2_Step_to_do)
*   [III. Practices](#III_Practices)
    *   [1\. Create Spring Boot project](#1_Create_Spring_Boot_project)
    *   [2\. Add needed dependencies](#2_Add_needed_dependencies)
    *   [3\. Re-implement the Entry point of Spring Boot Application](#3_Re-implement_the_Entry_point_of_Spring_Boot_Application)
    *   [4\. Implement a Bootstrap class for Start & Stop windows-service function](#4_Implement_a_Bootstrap_class_for_Start_038_Stop_windows-service_function)
    *   [5\. Create a simple web controller](#5_Create_a_simple_web_controller)
    *   [6\. Configure build plugin & start-class](#6_Configure_build_plugin_038_start-class)
    *   [7\. Download procrun](#7_Download_procrun)
    *   [8\. Build install, un-install, run, stop Procrun command-line for Spring Boot Windows Service](#8_Build_install_un-install_run_stop_Procrun_command-line_for_Spring_Boot_Windows_Service)
    *   [9\. Run & Enjoy result](#9_Run_038_Enjoy_result)
*   [IV. Source code](#IV_Source_code)

##### I. Technologies – create a Windows Service for Spring Boot Application by Procrun

– Java 1.8  
– Maven 3.3.9  
– Spring Tool Suite – Version 3.8.1.RELEASE  
– Spring Boot: 1.4.0.RELEASE  
– Procrun: commons-daemon-1.0.15

##### II. Overview

###### 1\. Structure of Project

![springbootwindowsservice-procrun-overview](https://grokonez.com/wp-content/uploads/2016/09/springbootwindowsservice-procrun-overview.png)

###### 2\. Step to do

– Create Spring Boot project  
– Add needed dependencies  
– Re-implement the Entry point of Spring Boot Application  
– Implement a Bootstrap class for Start & Stop windows-service function  
– Create a simple web controller  
– Configure build plugin & start-class  
– Download procrun  
– Build install, un-install, run, stop Procrun command-line for Spring Boot Windows Service  
– Run & Enjoy result

##### III. Practices

###### 1\. Create Spring Boot project

Open Spring Tool Suite, on main menu, choose **File->New->Spring Starter Project**, input project info as below images:

![springbootwindowsservice-procrun-create project](https://grokonez.com/wp-content/uploads/2016/09/springbootwindowsservice-procrun-create-project.png)

Press **Next** then **Finish**, spring boot project is created successfully.

###### 2\. Add needed dependencies

Open pom.xml file, add dependencies.

<dependencies> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-web</artifactId> </dependency> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-starter-test</artifactId> <scope>test</scope> </dependency> <dependency> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-loader</artifactId> <scope>provided</scope> </dependency> </dependencies>

<table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"><div class="crayon-nums-content"><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p></div></td><td class="crayon-code"><div class="crayon-pre"><p><span class="crayon-r ">&lt;dependencies&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;dependency&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;groupId&gt;</span><span class="crayon-i ">org.springframework.boot</span><span class="crayon-r ">&lt;/groupId&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;artifactId&gt;</span><span class="crayon-i ">spring-boot-starter-web</span><span class="crayon-r ">&lt;/artifactId&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/dependency&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;dependency&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;groupId&gt;</span><span class="crayon-i ">org.springframework.boot</span><span class="crayon-r ">&lt;/groupId&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;artifactId&gt;</span><span class="crayon-i ">spring-boot-starter-test</span><span class="crayon-r ">&lt;/artifactId&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;scope&gt;</span><span class="crayon-i ">test</span><span class="crayon-r ">&lt;/scope&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/dependency&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;dependency&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;groupId&gt;</span><span class="crayon-i ">org.springframework.boot</span><span class="crayon-r ">&lt;/groupId&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;artifactId&gt;</span><span class="crayon-i ">spring-boot-loader</span><span class="crayon-r ">&lt;/artifactId&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;scope&gt;</span><span class="crayon-i ">provided</span><span class="crayon-r ">&lt;/scope&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/dependency&gt;</span></p><p><span class="crayon-r ">&lt;/dependencies&gt;</span></p></div></td></tr></tbody></table>

###### 3\. Re-implement the Entry point of Spring Boot Application

For **start/stop** function of a Windows-Service, re-implement entry point class:

package com.javasampleapproach.windowsservice; import java.lang.management.ManagementFactory; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import org.springframework.boot.ExitCodeGenerator; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.context.ApplicationContext; @SpringBootApplication public class SpringBootWindowsServiceApplication { private static final Logger logger = LoggerFactory.getLogger(SpringBootWindowsServiceApplication.class); private static ApplicationContext applicationContext = null; public static void main(String\[\] args) { String mode = args != null && args.length > 0 ? args\[0\] : null; if (logger.isDebugEnabled()) { logger.debug("PID:" + ManagementFactory.getRuntimeMXBean().getName() + " Application mode:" + mode + " context:" + applicationContext); } if (applicationContext != null && mode != null && "stop".equals(mode)) { System.exit(SpringApplication.exit(applicationContext, new ExitCodeGenerator() { @Override public int getExitCode() { return 0; } })); } else { SpringApplication app = new SpringApplication(SpringBootWindowsServiceApplication.class); applicationContext = app.run(args); if (logger.isDebugEnabled()) { logger.debug("PID:" + ManagementFactory.getRuntimeMXBean().getName() + " Application started context:" + applicationContext); } } } }

<table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"><div class="crayon-nums-content"><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p></div></td><td class="crayon-code"><div class="crayon-pre"><p><span class="crayon-t">package</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">javasampleapproach</span><span class="crayon-sy">.</span><span class="crayon-v">windowsservice</span><span class="crayon-sy">;</span></p><p><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">java</span><span class="crayon-sy">.</span><span class="crayon-v">lang</span><span class="crayon-sy">.</span><span class="crayon-v">management</span><span class="crayon-sy">.</span><span class="crayon-v">ManagementFactory</span><span class="crayon-sy">;</span></p><p><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">slf4j</span><span class="crayon-sy">.</span><span class="crayon-v">Logger</span><span class="crayon-sy">;</span></p><p><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">slf4j</span><span class="crayon-sy">.</span><span class="crayon-v">LoggerFactory</span><span class="crayon-sy">;</span></p><p><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">springframework</span><span class="crayon-sy">.</span><span class="crayon-v">boot</span><span class="crayon-sy">.</span><span class="crayon-v">ExitCodeGenerator</span><span class="crayon-sy">;</span></p><p><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">springframework</span><span class="crayon-sy">.</span><span class="crayon-v">boot</span><span class="crayon-sy">.</span><span class="crayon-v">SpringApplication</span><span class="crayon-sy">;</span></p><p><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">springframework</span><span class="crayon-sy">.</span><span class="crayon-v">boot</span><span class="crayon-sy">.</span><span class="crayon-v">autoconfigure</span><span class="crayon-sy">.</span><span class="crayon-v">SpringBootApplication</span><span class="crayon-sy">;</span></p><p><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">springframework</span><span class="crayon-sy">.</span><span class="crayon-v">context</span><span class="crayon-sy">.</span><span class="crayon-v">ApplicationContext</span><span class="crayon-sy">;</span></p><p><span class="crayon-n">@SpringBootApplication</span></p><p><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">SpringBootWindowsServiceApplication</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-m">final</span><span class="crayon-h"> </span><span class="crayon-e">Logger </span><span class="crayon-v">logger</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">LoggerFactory</span><span class="crayon-sy">.</span><span class="crayon-e">getLogger</span><span class="crayon-sy">(</span><span class="crayon-v">SpringBootWindowsServiceApplication</span><span class="crayon-sy">.</span><span class="crayon-t">class</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-e">ApplicationContext </span><span class="crayon-v">applicationContext</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-t">String</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">logger</span><span class="crayon-sy">.</span><span class="crayon-e">isDebugEnabled</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">logger</span><span class="crayon-sy">.</span><span class="crayon-e">debug</span><span class="crayon-sy">(</span><span class="crayon-s">"PID:"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">ManagementFactory</span><span class="crayon-sy">.</span><span class="crayon-e">getRuntimeMXBean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">getName</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">" Application mode:"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">" context:"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">applicationContext</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">applicationContext</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-s">"stop"</span><span class="crayon-sy">.</span><span class="crayon-e">equals</span><span class="crayon-sy">(</span><span class="crayon-v">mode</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-v">SpringApplication</span><span class="crayon-sy">.</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-v">applicationContext</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">ExitCodeGenerator</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-n">@Override</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">getExitCode</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">SpringApplication </span><span class="crayon-v">app</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">SpringApplication</span><span class="crayon-sy">(</span><span class="crayon-v">SpringBootWindowsServiceApplication</span><span class="crayon-sy">.</span><span class="crayon-t">class</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">applicationContext</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">app</span><span class="crayon-sy">.</span><span class="crayon-e">run</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">logger</span><span class="crayon-sy">.</span><span class="crayon-e">isDebugEnabled</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">logger</span><span class="crayon-sy">.</span><span class="crayon-e">debug</span><span class="crayon-sy">(</span><span class="crayon-s">"PID:"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">ManagementFactory</span><span class="crayon-sy">.</span><span class="crayon-e">getRuntimeMXBean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">getName</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">" Application started context:"</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">applicationContext</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-sy">}</span></p></div></td></tr></tbody></table>

###### 4\. Implement a Bootstrap class for Start & Stop windows-service function

Create a **Bootstrap** class that extends **JarLauncher**. The class will implement 2 function **start & stop** for Windows-Service.

package com.javasampleapproach.windowsservice; import org.springframework.boot.loader.JarLauncher; import org.springframework.boot.loader.jar.JarFile; public class Bootstrap extends JarLauncher { private static ClassLoader classLoader = null; private static Bootstrap bootstrap = null; protected void launch(String\[\] args, String mainClass, ClassLoader classLoader, boolean wait) throws Exception { Thread.currentThread().setContextClassLoader(classLoader); Thread thread = new Thread(() -> { try { createMainMethodRunner(mainClass, args, classLoader).run(); } catch(Exception ex) {} }); thread.setContextClassLoader(classLoader); thread.setName(Thread.currentThread().getName()); thread.start(); if (wait == true) { thread.join(); } } public static void start (String \[\]args) { bootstrap = new Bootstrap (); try { JarFile.registerUrlProtocolHandler(); classLoader = bootstrap.createClassLoader(bootstrap.getClassPathArchives()); bootstrap.launch(args, bootstrap.getMainClass(), classLoader, true); } catch (Exception ex) { ex.printStackTrace(); System.exit(1); } } public static void stop (String \[\]args) { try { if (bootstrap != null) { bootstrap.launch(args, bootstrap.getMainClass(), classLoader, true); bootstrap = null; classLoader = null; } } catch (Exception ex) { ex.printStackTrace(); System.exit(1); } } public static void main(String\[\] args) { String mode = args != null && args.length > 0 ? args\[0\] : null; if ("start".equals(mode)) { Bootstrap.start(args); } else if ("stop".equals(mode)) { Bootstrap.stop(args); } } }

<table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"><div class="crayon-nums-content"><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p><p>42</p><p>43</p><p>44</p><p>45</p><p>46</p><p>47</p><p>48</p><p>49</p><p>50</p><p>51</p><p>52</p><p>53</p><p>54</p><p>55</p><p>56</p><p>57</p><p>58</p><p>59</p><p>60</p><p>61</p><p>62</p><p>63</p><p>64</p><p>65</p></div></td><td class="crayon-code"><div class="crayon-pre"><p><span class="crayon-t">package</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">javasampleapproach</span><span class="crayon-sy">.</span><span class="crayon-v">windowsservice</span><span class="crayon-sy">;</span></p><p><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">springframework</span><span class="crayon-sy">.</span><span class="crayon-v">boot</span><span class="crayon-sy">.</span><span class="crayon-v">loader</span><span class="crayon-sy">.</span><span class="crayon-v">JarLauncher</span><span class="crayon-sy">;</span></p><p><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">springframework</span><span class="crayon-sy">.</span><span class="crayon-v">boot</span><span class="crayon-sy">.</span><span class="crayon-v">loader</span><span class="crayon-sy">.</span><span class="crayon-v">jar</span><span class="crayon-sy">.</span><span class="crayon-v">JarFile</span><span class="crayon-sy">;</span></p><p><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">Bootstrap</span><span class="crayon-h"> </span><span class="crayon-r">extends</span><span class="crayon-h"> </span><span class="crayon-e">JarLauncher</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-e">ClassLoader </span><span class="crayon-v">classLoader</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-e">Bootstrap </span><span class="crayon-v">bootstrap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">protected</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">launch</span><span class="crayon-sy">(</span><span class="crayon-t">String</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">mainClass</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">ClassLoader </span><span class="crayon-v">classLoader</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">boolean</span><span class="crayon-h"> </span><span class="crayon-v">wait</span><span class="crayon-sy">)</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">throws</span><span class="crayon-h"> </span><span class="crayon-e">Exception</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Thread</span><span class="crayon-sy">.</span><span class="crayon-e">currentThread</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">setContextClassLoader</span><span class="crayon-sy">(</span><span class="crayon-v">classLoader</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Thread </span><span class="crayon-v">thread</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Thread</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">createMainMethodRunner</span><span class="crayon-sy">(</span><span class="crayon-v">mainClass</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classLoader</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">run</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-sy">(</span><span class="crayon-e">Exception </span><span class="crayon-v">ex</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thread</span><span class="crayon-sy">.</span><span class="crayon-e">setContextClassLoader</span><span class="crayon-sy">(</span><span class="crayon-v">classLoader</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thread</span><span class="crayon-sy">.</span><span class="crayon-e">setName</span><span class="crayon-sy">(</span><span class="crayon-v">Thread</span><span class="crayon-sy">.</span><span class="crayon-e">currentThread</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">getName</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thread</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">wait</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thread</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">start</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">bootstrap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Bootstrap</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">JarFile</span><span class="crayon-sy">.</span><span class="crayon-e">registerUrlProtocolHandler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">classLoader</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">bootstrap</span><span class="crayon-sy">.</span><span class="crayon-e">createClassLoader</span><span class="crayon-sy">(</span><span class="crayon-v">bootstrap</span><span class="crayon-sy">.</span><span class="crayon-e">getClassPathArchives</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">bootstrap</span><span class="crayon-sy">.</span><span class="crayon-e">launch</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bootstrap</span><span class="crayon-sy">.</span><span class="crayon-e">getMainClass</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classLoader</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Exception </span><span class="crayon-v">ex</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ex</span><span class="crayon-sy">.</span><span class="crayon-e">printStackTrace</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">stop</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">try</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">bootstrap</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">bootstrap</span><span class="crayon-sy">.</span><span class="crayon-e">launch</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bootstrap</span><span class="crayon-sy">.</span><span class="crayon-e">getMainClass</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">classLoader</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">bootstrap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">classLoader</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">catch</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">Exception </span><span class="crayon-v">ex</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ex</span><span class="crayon-sy">.</span><span class="crayon-e">printStackTrace</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">System</span><span class="crayon-sy">.</span><span class="crayon-e">exit</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-m">static</span><span class="crayon-h"> </span><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-t">String</span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-v">mode</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">.</span><span class="crayon-v">length</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"start"</span><span class="crayon-sy">.</span><span class="crayon-e">equals</span><span class="crayon-sy">(</span><span class="crayon-v">mode</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Bootstrap</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"stop"</span><span class="crayon-sy">.</span><span class="crayon-e">equals</span><span class="crayon-sy">(</span><span class="crayon-v">mode</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Bootstrap</span><span class="crayon-sy">.</span><span class="crayon-e">stop</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></p><p><span class="crayon-sy">}</span></p></div></td></tr></tbody></table>

###### 5\. Create a simple web controller

package com.javasampleapproach.windowsservice.controller; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RestController; @RestController public class WebController { @RequestMapping("/hello") public String hello(){ return "hello"; } }

<table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"></td><td class="crayon-code"><div class="crayon-pre"><p><span class="crayon-t">package</span><span class="crayon-h"> </span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">javasampleapproach</span><span class="crayon-sy">.</span><span class="crayon-v">windowsservice</span><span class="crayon-sy">.</span><span class="crayon-v">controller</span><span class="crayon-sy">;</span></p><p><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">springframework</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">bind</span><span class="crayon-sy">.</span><span class="crayon-v">annotation</span><span class="crayon-sy">.</span><span class="crayon-v">RequestMapping</span><span class="crayon-sy">;</span></p><p><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">org</span><span class="crayon-sy">.</span><span class="crayon-v">springframework</span><span class="crayon-sy">.</span><span class="crayon-v">web</span><span class="crayon-sy">.</span><span class="crayon-v">bind</span><span class="crayon-sy">.</span><span class="crayon-v">annotation</span><span class="crayon-sy">.</span><span class="crayon-v">RestController</span><span class="crayon-sy">;</span></p><p><span class="crayon-n">@RestController</span></p><p><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">WebController</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></p><p><span class="crayon-h"></span><span class="crayon-n">@RequestMapping</span><span class="crayon-sy">(</span><span class="crayon-s">"/hello"</span><span class="crayon-sy">)</span></p><p><span class="crayon-h"></span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">String</span><span class="crayon-h"> </span><span class="crayon-e">hello</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></p><p><span class="crayon-h"></span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"hello"</span><span class="crayon-sy">;</span></p><p><span class="crayon-h"></span><span class="crayon-sy">}</span></p><p><span class="crayon-sy">}</span></p></div></td></tr></tbody></table>

###### 6\. Configure build plugin & start-class

Open **pom.xml** file, configure start-class:

<properties> ... <!-- Main Class --> <start-class>com.javasampleapproach.windowsservice.SpringBootWindowsServiceApplication</start-class> ... </properties>

<table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"></td><td class="crayon-code"><div class="crayon-pre"><p><span class="crayon-e ">&lt;properties&gt;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></p><p><span class="crayon-h"></span><span class="crayon-o">&lt;</span><span class="crayon-o">!</span><span class="crayon-o">--</span><span class="crayon-h"> </span><span class="crayon-e">Main </span><span class="crayon-t">Class</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-o">&gt;</span></p><p><span class="crayon-h"></span><span class="crayon-o">&lt;</span><span class="crayon-v">start</span><span class="crayon-o">-</span><span class="crayon-t">class</span><span class="crayon-o">&gt;</span><span class="crayon-v">com</span><span class="crayon-sy">.</span><span class="crayon-v">javasampleapproach</span><span class="crayon-sy">.</span><span class="crayon-v">windowsservice</span><span class="crayon-sy">.</span><span class="crayon-v">SpringBootWindowsServiceApplication</span><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">start</span><span class="crayon-o">-</span><span class="crayon-t">class</span><span class="crayon-o">&gt;</span></p><p><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></p><p><span class="crayon-o">&lt;</span><span class="crayon-o">/</span><span class="crayon-v">properties</span><span class="crayon-o">&gt;</span></p></div></td></tr></tbody></table>

Configure Maven build plugin:

<build> <plugins> <plugin> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-maven-plugin</artifactId> <configuration> <excludes> <exclude> <groupId>org.springframework.boot</groupId> <artifactId>spring-boot-loader</artifactId> </exclude> </excludes> </configuration> </plugin> <plugin> <groupId>org.apache.maven.plugins</groupId> <artifactId>maven-antrun-plugin</artifactId> <version>1.8</version> <executions> <execution> <phase>package</phase> <configuration> <target> <zip destfile="${project.build.directory}/${project.build.finalName}.jar" update="true" compress="store"> <fileset dir="${project.build.directory}/classes" <strong>includes="com/javasampleapproach/windowsservice/Bootstrap.class"</strong> /> </zip> </target> </configuration> <goals> <goal>run</goal> </goals> </execution> </executions> </plugin> </plugins> </build>

<table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"><div class="crayon-nums-content"><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p></div></td><td class="crayon-code"><div class="crayon-pre"><p><span class="crayon-r ">&lt;build&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;plugins&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;plugin&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;groupId&gt;</span><span class="crayon-i ">org.springframework.boot</span><span class="crayon-r ">&lt;/groupId&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;artifactId&gt;</span><span class="crayon-i ">spring-boot-maven-plugin</span><span class="crayon-r ">&lt;/artifactId&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;configuration&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;excludes&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;exclude&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;groupId&gt;</span><span class="crayon-i ">org.springframework.boot</span><span class="crayon-r ">&lt;/groupId&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;artifactId&gt;</span><span class="crayon-i ">spring-boot-loader</span><span class="crayon-r ">&lt;/artifactId&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/exclude&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/excludes&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/configuration&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/plugin&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;plugin&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;groupId&gt;</span><span class="crayon-i ">org.apache.maven.plugins</span><span class="crayon-r ">&lt;/groupId&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;artifactId&gt;</span><span class="crayon-i ">maven-antrun-plugin</span><span class="crayon-r ">&lt;/artifactId&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;version&gt;</span><span class="crayon-i ">1.8</span><span class="crayon-r ">&lt;/version&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;executions&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;execution&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;phase&gt;</span><span class="crayon-i ">package</span><span class="crayon-r ">&lt;/phase&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;configuration&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;target&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;zip </span><span class="crayon-e ">destfile</span><span class="crayon-o">=</span><span class="crayon-s ">"${project.build.directory}/${project.build.finalName}.jar"</span></p><p><span class="crayon-h"></span><span class="crayon-e ">update</span><span class="crayon-o">=</span><span class="crayon-s ">"true"</span><span class="crayon-h"> </span><span class="crayon-e ">compress</span><span class="crayon-o">=</span><span class="crayon-s ">"store"</span><span class="crayon-r ">&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;fileset </span><span class="crayon-e ">dir</span><span class="crayon-o">=</span><span class="crayon-s ">"${project.build.directory}/classes"</span></p><p><span class="crayon-h"></span><span class="crayon-r ">&lt;strong&gt;</span><span class="crayon-i ">includes="com/javasampleapproach/windowsservice/Bootstrap.class"</span><span class="crayon-r ">&lt;/strong&gt;</span><span class="crayon-r "> /&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/zip&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/target&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/configuration&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;goals&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;goal&gt;</span><span class="crayon-i ">run</span><span class="crayon-r ">&lt;/goal&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/goals&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/execution&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/executions&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/plugin&gt;</span></p><p><span class="crayon-i "></span><span class="crayon-r ">&lt;/plugins&gt;</span></p><p><span class="crayon-r ">&lt;/build&gt;</span></p></div></td></tr></tbody></table>

###### 7\. Download procrun

Download Procrun from: [Commons-Deamon](http://commons.apache.org/proper/commons-daemon/download_daemon.cgi)

###### 8\. Build install, un-install, run, stop Procrun command-line for Spring Boot Windows Service

– Create **install.bat** file

prunsrv.exe //IS//Procrun-SpringBootWindowService --DisplayName="Procrun-SpringBootWindowService" --Description="Procrun-SpringBootWindowService" ^ --Startup=auto --Install=%CD%\\prunsrv.exe --Jvm=auto --Classpath=%CD%\\..\\target\\springbootwindowsservice-0.0.1.jar ^ --StartMode=jvm --StartClass=com.javasampleapproach.windowsservice.Bootstrap --StartMethod=start --StartParams=start ^ --StopMode=jvm --StopClass=com.javasampleapproach.windowsservice.Bootstrap --StopMethod=stop --StopParams=stop ^ --StdOutput=auto --StdError=auto --LogPath=%CD% --LogLevel=Debug ^

<table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"></td><td class="crayon-code"><div class="crayon-pre"><p>prunsrv.exe //IS//Procrun-SpringBootWindowService --DisplayName="Procrun-SpringBootWindowService" --Description="Procrun-SpringBootWindowService" ^</p><p>--Startup=auto --Install=%CD%\prunsrv.exe --Jvm=auto --Classpath=%CD%\..\target\springbootwindowsservice-0.0.1.jar ^</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--StartMode=jvm --StartClass=com.javasampleapproach.windowsservice.Bootstrap --StartMethod=start --StartParams=start ^</p><p>--StopMode=jvm --StopClass=com.javasampleapproach.windowsservice.Bootstrap --StopMethod=stop --StopParams=stop ^</p><p>--StdOutput=auto --StdError=auto --LogPath=%CD% --LogLevel=Debug ^</p></div></td></tr></tbody></table>

– Create **uninstall.bat** file

prunsrv.exe //DS//Procrun-SpringBootWindowService

<table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"></td><td class="crayon-code"><div class="crayon-pre"><p><span class="crayon-v">prunsrv</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-c">//DS//Procrun-SpringBootWindowService</span></p></div></td></tr></tbody></table>

– Create **run.bat** file

prunsrv.exe //ES//Procrun-SpringBootWindowService

<table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"></td><td class="crayon-code"><div class="crayon-pre"><p><span class="crayon-v">prunsrv</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-c">//ES//Procrun-SpringBootWindowService</span></p></div></td></tr></tbody></table>

– Create **stop.bat** file

prunsrv.exe //SS//Procrun-SpringBootWindowService

<table class="crayon-table"><tbody><tr class="crayon-row"><td class="crayon-nums " data-settings="hide"></td><td class="crayon-code"><div class="crayon-pre"><p><span class="crayon-v">prunsrv</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-c">//SS//Procrun-SpringBootWindowService</span></p></div></td></tr></tbody></table>

– Use **echo %PROCESSOR\_ARCHITECTURE%** for determined the appropriate procrun.exe

– Place all files: install.bat, uninstall.bat, run.bat, stop.bat and prunsrv.exe in a **procrun** folder.

###### 9\. Run & Enjoy result

\-Maven build project with goals:  
`clean install`

– Open **cmd** on windows with mode:**administrator privileges**, cd to **procrun** folder.

– Run **install.bat** – for register a Window Service  
– Run **run.bat** – for start the Windows-Service

![springbootwindowsservice-procrun-service running](https://grokonez.com/wp-content/uploads/2016/09/springbootwindowsservice-procrun-service-running.png)

Make request:  
`http://localhost:8080/hello`

![springbootwindowsservice-procrun-request](https://grokonez.com/wp-content/uploads/2016/09/springbootwindowsservice-procrun-request.png)

– Run **stop.bat**: for stop Windows-service  
– Run **uninstall.bat**: for un-register Windows-Service

##### IV. Source code

[SpringBootWindowsService](https://grokonez.com/wp-content/uploads/2016/09/SpringBootWindowsService.zip)

Last updated on **June 4, 2017**.
